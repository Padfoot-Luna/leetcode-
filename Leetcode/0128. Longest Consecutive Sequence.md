`Hard`

> 给定一个未排序的整数数组，找出最长**连续序列**的长度。
>
> 要求算法的时间复杂度为 *O(n)*。

#### 1. Hashset

```python
class Solution:
    def longestConsecutive(self, nums: List[int]) -> int:
        ans = 0
        hashset = set(nums)
        for x in hashset:
            if x-1 not in hashset:  # 只从连续序列的最小值开始找, 不是则跳过
                count = 1
                x += 1
                while x in hashset:
                    x += 1
                    count += 1
                ans = max(ans, count)
        return ans
```



---

#### 2. 并查集

```python
class Solution:
    def longestConsecutive(self, nums: List[int]) -> int:
        if not nums: return 0
        nums = set(nums)
        parent = {i:i for i in nums}
        size = {i:1 for i in nums}
        def find(x):
            if x != parent[x]:
                parent[x] = parent[parent[x]]
                x = parent[x]
            return x
        def union(x,y):
            p, q = find(x), find(y)
            if p != q:
                if size[p] > size[q]:
                    parent[q] = p
                    size[p] += size[q]
                    return size[p]
                else:
                    parent[p] = q
                    size[q] += size[p]
                    return size[q]
            return size[p]
        ans = 1
        for x in nums:
            if x+1 in nums:
                ans = max(ans, union(x,x+1))
        return ans
```

